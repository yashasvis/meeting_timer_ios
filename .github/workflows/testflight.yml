name: Upload to TestFlight 
 
on: 
  push: 
    branches: 
      - main 
 
jobs: 
  build: 
    runs-on: macos-14 
 
    steps: 
      - name: Checkout 
        uses: actions/checkout@v4 
 
      - name: Select Xcode 15.4 
        run: sudo xcode-select -s /Applications/Xcode_15.4.app 
 
      - name: Install certificates & profiles 
        uses: apple-actions/import-codesign-certs@v3 
        with: 
          p12-file-base64: ${{ secrets.IOS_CERTIFICATE }} 
          p12-password: ${{ secrets.KEYCHAIN_PASSWORD }} 
          provisioning-profile-base64: ${{ secrets.IOS_PROVISION_PROFILE }} 
 
      - name: Build & Archive 
        run: | 
          xcodebuild archive \ 
            -workspace YourApp.xcworkspace \ 
            -scheme YourScheme \ 
            -configuration Release \ 
            -archivePath build/YourApp.xcarchive \ 
            -destination 'generic/platform=iOS' 
 
      - name: Upload to TestFlight 
        uses: apple-actions/upload-testflight-build@v1 
        with: 
          app-path: build/YourApp.xcarchive 
          issuer-id: ${{ secrets.APP_STORE_ISSUER_ID }} 
          api-key-id: ${{ secrets.APP_STORE_KEY_ID }} 
          api-private-key: ${{ secrets.APP_STORE_PRIVATE_KEY }}
